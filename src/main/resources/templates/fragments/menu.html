<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<body>
	<div th:fragment="menu">
		<!--  MenuSection  -->
		<div id="menu"
			class="text-center bg-dark text-light has-height-md middle-items wow fadeIn">
			<h2 class="section-title">MENU</h2>
		</div>
		<div class="row justify-content-center">
			<div class="col-sm-7 col-md-4 mb-5">
				<ul id="menu-list" class="nav nav-pills nav-justified mb-3"></ul>
				<ul class="nav nav-pills nav-justified mb-3" id="pills-tab"
					role="tablist">
					<li class="nav-item" th:each="categoria, iter : ${categorias}">
						<a class="nav-link" th:classappend="${iter.first} ? 'active' : ''"
						data-toggle="pill" th:href="'#' + ${categoria}"
						th:text="${categoria}"> </a>
					</li>
				</ul>
			</div>
		</div>
		<div class="tab-content" id="pills-tabContent">
			<!-- Itera sobre las categorías pasadas desde el controlador -->
			<div th:each="categoria, iter : ${categorias}" class="tab-pane fade"
				th:classappend="${iter.first} ? 'show active' : ''"
				th:id="${categoria}" role="tabpanel">
				<div class="row">
					<!-- Itera sobre los productos y filtra por categoría -->
					<div th:each="producto : ${productos}"
						th:if="${producto.category.equals(categoria)}" class="col-md-4">
						<div class="card bg-transparent border my-3 my-md-0">
							<div th:id="'carousel-' + ${producto.id}" class="carousel slide"
								data-ride="carousel">
								<div class="carousel-inner">
									<!-- Itera sobre las imágenes del producto -->
									<div th:each="imagen, iterStat : ${producto.imagenes}"
										class="carousel-item"
										th:classappend="${iterStat.first} ? 'active' : ''">
										<img th:src="@{${imagen.imageUrl}}" class="d-block w-100"
											th:alt="'Imagen de ' + ${producto.productName}">
									</div>
								</div>
								<!-- Controles del carrusel -->
								<a class="carousel-control-prev"
									th:href="'#carousel-' + ${producto.id}" role="button"
									data-slide="prev"> <span class="carousel-control-prev-icon"
									aria-hidden="true"></span> <span class="sr-only">Anterior</span>
								</a> <a class="carousel-control-next"
									th:href="'#carousel-' + ${producto.id}" role="button"
									data-slide="next"> <span class="carousel-control-next-icon"
									aria-hidden="true"></span> <span class="sr-only">Siguiente</span>
								</a>
							</div>
							<div class="card-body">
								<h1 class="text-center mb-4">
									<a href="#" class="badge badge-primary"
										th:text="${producto.price}"></a>
								</h1>
								<h4 class="pt20 pb20" th:text="${producto.productName}"></h4>
								<p class="text-white" th:text="${producto.description}"></p>

								<!-- Selector de cantidad -->
								<div class="mb-3 d-flex align-items-center">
									<label for="quantity-[[${producto.id}]]"
										class="text-white mr-2">Cantidad:</label> <input type="number"
										th:id="'quantity-' + ${producto.id}" name="quantity"
										class="form-control-modern" min="1" value="1"
										style="width: 3.0rem; text-align: center;">
								</div>

								<div class="text-center">
									<button class="btn btn-primary btn-sm px-3 add-to-cart"
										th:attr="data-name=${producto.productName}, data-price=${producto.price}, data-quantity-id='quantity-' + ${producto.id}">
										Agregar al carrito</button>
								</div>
							</div>

						</div>
					</div>
					<!-- Fin del loop de productos -->
				</div>
			</div>
			<!-- Fin del loop de categorías -->
		</div>
	</div>
</body>
</html>
