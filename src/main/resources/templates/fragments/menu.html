<div th:fragment="menu">
	<!-- Encabezado del Menú -->
	<div id="menu"
		class="text-center bg-dark text-light has-height-md middle-items wow fadeIn">
		<h2 class="section-title">
			<a href="/menu" class="text-light text-decoration-none">MENU</a>
		</h2>
	</div>

	<!-- Barra de categorías superior -->
	<div class="bg-dark text-light py-2 px-3 sticky-top"
		style="z-index: 1000;">
		<div class="d-flex flex-wrap justify-content-center category-scroll">
			<a th:each="categoria : ${categorias}"
				class="btn btn-outline-light btn-sm mx-2 mb-2"
				th:href="'#cat-' + ${#strings.replace(categoria, ' ', '-')}"
				th:text="${categoria}"></a>
		</div>
	</div>

	<!-- Contenedor principal -->
	<div class="container-fluid mt-4">
		<div class="row">
			<div class="col-12">
				<div th:each="categoria : ${categorias}" class="mb-5"
					th:id="'cat-' + ${#strings.replace(categoria, ' ', '-')}">

					<!-- Nombre de la categoría -->
					<h4 class="text-light mb-3" th:text="${categoria}"></h4>

					<!-- Wrapper con sombra fija -->
					<div class="product-wrapper">
						<!-- Carrusel horizontal de productos -->
						<div class="d-flex product-scroll">
						<div th:each="producto : ${productos}"
     th:if="${producto.categoria.nombre == categoria}"
     class="card bg-transparent border text-white mr-3 position-relative"
     style="min-width: 200px; max-width: 210px; flex: 0 0 auto;">

								
<span th:if="${producto.tienePromocion}"
      class="badge badge-descuento badge-pulse position-absolute m-2"
      style="top: 0.5rem; right: 0.5rem; z-index: 2;">
    -<span th:text="${producto.porcentajeDescuento}">0</span>%
</span>


				<div th:if="${producto.imagenes != null and #lists.size(producto.imagenes) > 0}" 
     th:id="'carousel-' + ${producto.id}" 
     class="carousel slide mb-2" data-bs-ride="carousel" data-bs-interval="3000">
    
    <div class="carousel-inner">
        <div th:each="imagen, iterStat : ${producto.imagenes}" 
             th:classappend="${iterStat.index == 0} ? 'active'" 
             class="carousel-item">
            <img th:src="@{${imagen.imageUrl != null ? imagen.imageUrl : '/imgs/default.png'}}"
                 class="d-block w-100" alt="Imagen producto"
                 style="max-height: 250px; object-fit: cover;">
        </div>
    </div>

    <!-- Controles opcionales -->
    <button class="carousel-control-prev" type="button" 
            th:attr="data-bs-target='#carousel-' + ${producto.id}" 
            data-bs-slide="prev">
        <span class="carousel-control-prev-icon"></span>
    </button>
    <button class="carousel-control-next" type="button" 
            th:attr="data-bs-target='#carousel-' + ${producto.id}" 
            data-bs-slide="next">
        <span class="carousel-control-next-icon"></span>
    </button>
</div>



								<div class="card-body text-center">
									<h5 class="card-title" th:text="${producto.productName}"></h5>

									<!-- Precio -->
									<div class="mb-2">
										<span th:if="${producto.tienePromocion}"> <del
												class="text-muted">
												$<span
													th:text="${#numbers.formatDecimal(producto.price, 1, 'POINT', 0, 'NONE')}"></span>
											</del> <span class="badge badge-success ml-2"> $<span
												th:text="${#numbers.formatDecimal(producto.precioConDescuento, 1, 'POINT', 0, 'NONE')}"></span>
										</span> 
										</span> <span th:if="${!producto.tienePromocion}"> <span
											class="badge badge-primary"> $<span
												th:text="${#numbers.formatDecimal(producto.price, 1, 'POINT', 0, 'NONE')}"></span>
										</span>
										</span>
									</div>

									<!-- Cantidad y botón -->
									<div
										class="d-flex justify-content-center align-items-center mb-2">
										<input type="number" th:id="'quantity-' + ${producto.id}"
											name="quantity"
											class="form-control form-control-sm text-center mr-2"
											value="1" min="1" style="width: 60px;">
										<button class="btn btn-sm btn-success add-to-cart"
											th:attr="data-name=${producto.productName}, data-price=${producto.price}, data-quantity-id='quantity-' + ${producto.id}">
											+</button>
									</div>
									<!-- Descripción corta -->
									<div class="descripcion-corta text-light small mb-2 text-left">
    <span th:text="${producto.description}"></span>
</div>
                                     

									<!-- Botón ver más / ver menos -->
									<div class="text-left">
										<a href="javascript:void(0);" class="ver-mas text-info"
											onclick="toggleDescripcion(this)"> <span>Ver más</span>
										</a>
									</div>

								</div>
							</div>
						</div>
						<!-- Fin .product-scroll -->
					</div>
					<!-- Fin .product-wrapper -->

				</div>
				<!-- Fin de categoría -->
			</div>
		</div>
	</div>
</div>
